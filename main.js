!function(){"use strict";class e{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector)),this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_showInputError(e,t){const n=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._config.inputErrorClass),n.textContent=t,n.classList.add(this._config.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}}class t{constructor(e,t,n){this._cardData=e,this._cardTemplateSelector=t,this._openImageModal=()=>n(this._cardData)}_getElement(){return document.querySelector(this._cardTemplateSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._deleteButton.addEventListener("click",this._deleteCard),this._likeButton.addEventListener("click",this._toggleLike),this._cardImageEl.addEventListener("click",this._openImageModal)}_deleteCard=()=>{this._cardElement.remove(),this._cardElement=null};_toggleLike=()=>{this._likeButton.classList.toggle("card__like-button_active")};generateCard(){return this._cardElement=this._getElement(),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImageEl.src=this._cardData.link,this._cardImageEl.alt=this._cardData.name,this._cardTitleEl.textContent=this._cardData.name,this._setEventListeners(),this._cardElement}}var n=class{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal__close")||e.target===this._popupElement)&&this.close()}))}};class s extends n{constructor(e,t){super(e),this._handleSubmit=t,this._formElement=this._popupElement.querySelector("form")}_getInputValues(){const e=this._formElement.querySelectorAll("input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit(this._getInputValues()),this.close()}))}close(){super.close(),this._formElement.reset()}}const o=document.querySelector("#profile-edit-button"),i=document.querySelector("#profile-title-input"),r=document.querySelector("#profile-description-input"),a=document.querySelector(".profile__add-button"),l=(document.querySelector(".card__list"),document.querySelector("#add-modal-title-input"),document.querySelector("#cardUrlInput"),new class{constructor(e){let{nameSelector:t,jobSelector:n}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(n)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}({nameSelector:".profile__title",jobSelector:".profile__description"}));document.querySelector(".modal__form");const c=new s("#profile-edit-modal",(function(e){l.setUserInfo(e.name,e.job)}));c.setEventListeners();const d=new s("#add-modal",(function(e){const t=u(e);_.addItem(t),d.close()}));function m(e){p.open(e)}function u(e){return new t(e,"#card-template",m).generateCard()}d.setEventListeners(),o.addEventListener("click",(()=>{E.resetValidation(),function(){const{name:e,job:t}=l.getUserInfo();i.value=e,r.value=t,c.open()}(),c.open()})),a.addEventListener("click",(()=>{g.resetValidation(),d.open()}));const _=new class{constructor(e,t){let{items:n,renderer:s}=e;this._items=n,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer.bind(this))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg "}],renderer:e=>{const t=u(e);_.addItem(t)}},".card__list");_.renderItems();const h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},p=new class extends n{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._imageCaption=this._popupElement.querySelector(".modal__preview-title")}open(e){this._imageElement.src=e.link,this._imageElement.alt=e.name,this._imageCaption.textContent=e.name,super.open()}}("#preview__image-modal");p.setEventListeners();const E=new e(h,document.querySelector("#profile-edit-modal form"));E.enableValidation();const g=new e(h,document.querySelector("#add-modal form"));g.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBV3pFLElBQ1QsTUFBTStELEVBQWNDLEVBQVdoRSxHQUMvQmlFLEVBQVNDLFFBQVFILEVBQVksR0FHakMsZUFHRkUsRUFBU1ksY0FHVCxNQUFNdkgsRUFBUyxDQUNiMEgsYUFBYyxlQUNkakgsY0FBZSxnQkFDZkcscUJBQXNCLHNCQUN0QlMsb0JBQXFCLHlCQUNyQk0sZ0JBQWlCLDBCQUNqQkMsV0FBWSx3QkFJUmlGLEVBQWEsSUd6R0osY0FBeUI5QixFQUN0Q2hGLFlBQVk0SCxHQUNWMUMsTUFBTTBDLEdBQ056SCxLQUFLMEgsY0FBZ0IxSCxLQUFLaUUsY0FBY3hELGNBQ3RDLHlCQUVGVCxLQUFLMkgsY0FBZ0IzSCxLQUFLaUUsY0FBY3hELGNBQ3RDLHdCQUVKLENBRUEyRCxLQUFLd0QsR0FDSDVILEtBQUswSCxjQUFjOUQsSUFBTWdFLEVBQVUvRCxLQUNuQzdELEtBQUswSCxjQUFjNUQsSUFBTThELEVBQVU3RCxLQUNuQy9ELEtBQUsySCxjQUFjaEcsWUFBY2lHLEVBQVU3RCxLQUUzQ2dCLE1BQU1YLE1BQ1IsR0h3RmdDLHlCQUNsQ3VDLEVBQVduQyxvQkFHWCxNQUFNb0MsRUFBMkIsSUFBSWhILEVBQ25DRSxFQUNBaUQsU0FBU3RDLGNBQWMsNkJBRXpCbUcsRUFBeUJ6RSxtQkFFekIsTUFBTTJFLEVBQXVCLElBQUlsSCxFQUMvQkUsRUFDQWlELFNBQVN0QyxjQUFjLG9CQUV6QnFHLEVBQXFCM0Usa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0ltYWdlUG9wdXAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcblxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9jb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcblxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCBjYXJkVGVtcGxhdGVTZWxlY3Rvciwgb3BlbkltYWdlTW9kYWwpIHtcbiAgICB0aGlzLl9jYXJkRGF0YSA9IGNhcmREYXRhO1xuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZVNlbGVjdG9yID0gY2FyZFRlbXBsYXRlU2VsZWN0b3I7XG4gICAgdGhpcy5fb3BlbkltYWdlTW9kYWwgPSAoKSA9PiBvcGVuSW1hZ2VNb2RhbCh0aGlzLl9jYXJkRGF0YSk7XG4gIH1cbiAgX2dldEVsZW1lbnQoKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkVGVtcGxhdGVTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2RlbGV0ZUNhcmQpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX3RvZ2dsZUxpa2UpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9vcGVuSW1hZ2VNb2RhbCk7XG4gIH1cblxuICBfZGVsZXRlQ2FyZCA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfTtcblxuICBfdG9nZ2xlTGlrZSA9ICgpID0+IHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH07XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0RWxlbWVudCgpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGVFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9jYXJkRGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX2NhcmREYXRhLm5hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9jYXJkRGF0YS5uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyLmJpbmQodGhpcykpO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2VjdGlvbjtcbiIsImNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKSB8fFxuICAgICAgICBlLnRhcmdldCA9PT0gdGhpcy5fcG9wdXBFbGVtZW50XG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBQb3B1cDtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRzID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0XCIpO1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICB9XG59XG4iLCIvLyBJbXBvcnQgc3RhdGVtZW50c1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgSW1hZ2VQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9JbWFnZVBvcHVwLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG4vLyBET00gRWxlbWVudHNcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saXN0XCIpO1xuY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1tb2RhbC10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IGNhcmRVcmxJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZFVybElucHV0XCIpO1xuXG4vLyBVc2VyIEluZm9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbn0pO1xuXG4vLyBQcm9maWxlIEVkaXQgRm9ybVxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICBjb25zdCB7IG5hbWUsIGpvYiB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBuYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGpvYjtcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XG59XG5cbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbi8vIEFkZCBDYXJkIEZvcm1cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gIGNhcmRMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcbn1cblxuLy8gUG9wdXAgSW5pdGlhbGl6YXRpb25cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoZm9ybURhdGEpIHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oZm9ybURhdGEubmFtZSwgZm9ybURhdGEuam9iKTtcbn1cblxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5wcm9maWxlRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2FkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gRXZlbnQgTGlzdGVuZXJzXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XG4gIHByb2ZpbGVFZGl0UG9wdXAub3BlbigpO1xufSk7XG5cbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gQ2FyZC1yZWxhdGVkIEZ1bmN0aW9uc1xuZnVuY3Rpb24gb3BlbkltYWdlTW9kYWwoY2FyZERhdGEpIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgb3BlbkltYWdlTW9kYWwpO1xuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuLy8gQ2FyZCBTZWN0aW9uXG5jb25zdCBjYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgY2FyZExpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZF9fbGlzdFwiXG4pO1xuXG5jYXJkTGlzdC5yZW5kZXJJdGVtcygpO1xuXG4vLyBGb3JtIFZhbGlkYXRpb24gQ29uZmlndXJhdGlvbnNcbmNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbi8vIEltYWdlIFBvcHVwXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IEltYWdlUG9wdXAoXCIjcHJldmlld19faW1hZ2UtbW9kYWxcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEZvcm0gVmFsaWRhdG9yc1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGNvbmZpZyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWwgZm9ybVwiKVxuKTtcbnByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGNvbmZpZyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtbW9kYWwgZm9ybVwiKVxuKTtcbmFkZENhcmRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFVzZXJJbmZvO1xuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxuICB9LFxuXTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbWFnZVBvcHVwIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpIHtcbiAgICBzdXBlcihwb3B1cEVsZW1lbnQpO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy10aXRsZVwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oaW1hZ2VEYXRhKSB7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGltYWdlRGF0YS5saW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBpbWFnZURhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBpbWFnZURhdGEubmFtZTtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9jb25maWciLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJfYnV0dG9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiaW5wdXRFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImNsYXNzTGlzdCIsImFkZCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsInJlbW92ZSIsIl9oaWRlSW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsImlkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInRleHRDb250ZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJDYXJkIiwiY2FyZERhdGEiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsIm9wZW5JbWFnZU1vZGFsIiwiX2NhcmREYXRhIiwiX2NhcmRUZW1wbGF0ZVNlbGVjdG9yIiwiX29wZW5JbWFnZU1vZGFsIiwiX2dldEVsZW1lbnQiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsIl9kZWxldGVCdXR0b24iLCJfZGVsZXRlQ2FyZCIsIl9saWtlQnV0dG9uIiwiX3RvZ2dsZUxpa2UiLCJfY2FyZEltYWdlRWwiLCJfY2FyZEVsZW1lbnQiLCJ0b2dnbGUiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZFRpdGxlRWwiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImUiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJQb3B1cCIsImhhbmRsZVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0cyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInVzZXJJbmZvIiwiX3JlZiIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwicHJvZmlsZUVkaXRQb3B1cCIsImZvcm1EYXRhIiwiYWRkQ2FyZFBvcHVwIiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwiY2FyZExpc3QiLCJhZGRJdGVtIiwiaW1hZ2VQb3B1cCIsInByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvciIsImZpbGxQcm9maWxlRm9ybSIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZWxlbWVudCIsInByZXBlbmQiLCJmb3JtU2VsZWN0b3IiLCJwb3B1cEVsZW1lbnQiLCJfaW1hZ2VFbGVtZW50IiwiX2ltYWdlQ2FwdGlvbiIsImltYWdlRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=